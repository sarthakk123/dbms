import com.mongodb.client.*;
import com.mongodb.client.model.Filters;
import com.mongodb.client.model.Updates;
import org.bson.Document;
import java.util.Scanner;

public class Main {
    private static MongoClient mongoClient;
    private static MongoDatabase database;
    private static MongoCollection<Document> collection;
    private static Scanner sc = new Scanner(System.in);

    public static void main(String[] args) {
        try {
            mongoClient = MongoClients.create("mongodb://localhost:27017");
            database = mongoClient.getDatabase("studentdb");
            collection = database.getCollection("students");
            System.out.println("Connected to MongoDB database");

            int choice;
            do {
                System.out.println("\nDATABASE NAVIGATION MENU");
                System.out.println("1. Add Record");
                System.out.println("2. View Records");
                System.out.println("3. Update Record");
                System.out.println("4. Delete Record");
                System.out.println("5. Exit");
                System.out.print("Enter your choice: ");
                choice = sc.nextInt();

                switch (choice) {
                    case 1:
                        addRecord();
                        break;
                    case 2:
                        viewRecords();
                        break;
                    case 3:
                        updateRecord();
                        break;
                    case 4:
                        deleteRecord();
                        break;
                    case 5:
                        System.out.println("Exiting...");
                        break;
                    default:
                        System.out.println("Invalid choice");
                }
            } while (choice != 5);

            mongoClient.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private static void addRecord() {
        System.out.print("Enter name: ");
        String name = sc.next();
        System.out.print("Enter age: ");
        int age = sc.nextInt();
        System.out.print("Enter city: ");
        String city = sc.next();

        Document doc = new Document("name", name)
                .append("age", age)
                .append("city", city);
        collection.insertOne(doc);
        System.out.println("Record added successfully");
    }

    private static void viewRecords() {
        System.out.println("\nSTUDENT RECORDS");
        for (Document doc : collection.find()) {
            System.out.println("ID: " + doc.getObjectId("_id"));
            System.out.println("Name: " + doc.getString("name"));
            System.out.println("Age: " + doc.getInteger("age"));
            System.out.println("City: " + doc.getString("city"));
            System.out.println("----------------------------");
        }
    }

    private static void updateRecord() {
        System.out.print("Enter student name to update: ");
        String name = sc.next();
        System.out.print("Enter new city: ");
        String city = sc.next();

        collection.updateOne(Filters.eq("name", name), Updates.set("city", city));
        System.out.println("Record updated successfully");
    }

    private static void deleteRecord() {
        System.out.print("Enter student name to delete: ");
        String name = sc.next();

        collection.deleteOne(Filters.eq("name", name));
        System.out.println("Record deleted successfully");
    }
}
